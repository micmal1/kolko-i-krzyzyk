<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Kółko-Krzyżyk Online</title>
  <style>
    body { font-family: Arial; text-align: center; margin-top: 50px; }
    #board { display: grid; grid-template-columns: repeat(3, 100px); grid-gap: 5px; justify-content: center; margin-bottom: 20px; }
    .cell { width: 100px; height: 100px; background: #eee; display: flex; justify-content: center; align-items: center; font-size: 48px; cursor: pointer; }
    #status { font-size: 20px; margin-bottom: 10px; }
    input, button { font-size: 16px; padding: 5px; margin: 5px; }
  </style>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
</head>
<body>

<h1>Kółko-Krzyżyk Online</h1>
<input id="nameInput" placeholder="Twoja nazwa">
<button id="joinBtn">Dołącz</button>
<div id="statusText"></div>

<div id="game" style="display:none;">
  <h2 id="opponent"></h2>
  <div id="board">
    <div class="cell" data-idx="0"></div>
    <div class="cell" data-idx="1"></div>
    <div class="cell" data-idx="2"></div>
    <div class="cell" data-idx="3"></div>
    <div class="cell" data-idx="4"></div>
    <div class="cell" data-idx="5"></div>
    <div class="cell" data-idx="6"></div>
    <div class="cell" data-idx="7"></div>
    <div class="cell" data-idx="8"></div>
  </div>
</div>

<script>
  // Wklej tutaj swój firebaseConfig
  const firebaseConfig = {
    apiKey: "AIzaSyChzHJ5AWbI-IewwPxfFiSGn6ViJsfSG-A",
    authDomain: "kolko-i-krzyzyk-d96f7.firebaseapp.com",
    databaseURL: "https://kolko-i-krzyzyk-d96f7-default-rtdb.firebaseio.com",
    projectId: "kolko-i-krzyzyk-d96f7",
    storageBucket: "kolko-i-krzyzyk-d96f7.firebasestorage.app",
    messagingSenderId: "1038088392191",
    appId: "1:1038088392191:web:cb1f4fe0060e039d2f6bca"
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  let playerName, playerSymbol, playerKey, gameKey, myTurn;
  const joinBtn = document.getElementById("joinBtn");
  const statusText = document.getElementById("statusText");

  joinBtn.addEventListener("click", () => {
    playerName = document.getElementById("nameInput").value || "Anon";
    joinBtn.disabled = true;
    document.getElementById("nameInput").disabled = true;

    statusText.innerText = "Szukanie przeciwnika..."; // pokazujemy status

    const queueRef = db.ref("queue");
    const playerRef = queueRef.push({name: playerName});
    playerKey = playerRef.key;

    queueRef.on("child_added", snapshot => {
      const players = snapshot.ref.parent;
      players.once("value").then(snap => {
        const allPlayers = snap.val() || {};
        const keys = Object.keys(allPlayers);
        if(keys.length >= 2){
          const [p1Key, p2Key] = keys;
          gameKey = db.ref("games").push().key;
          db.ref("games/"+gameKey).set({
            board: Array(9).fill(""),
            turn: p1Key,
            players: {
              [p1Key]: allPlayers[p1Key].name,
              [p2Key]: allPlayers[p2Key].name
            }
          });
          db.ref("queue").remove();
          statusText.innerText = ""; // usuwamy "szukanie"
          document.getElementById("game").style.display = "block";
          startGame(gameKey, playerKey === p1Key ? "X" : "O");
        }
      });
    });
  });

  function startGame(key, symbol){
    playerSymbol = symbol;
    gameKey = key;
    const gameRef = db.ref("games/"+gameKey);
    myTurn = false;

    const cells = document.querySelectorAll(".cell");
    cells.forEach(cell => {
      cell.addEventListener("click", ()=>{
